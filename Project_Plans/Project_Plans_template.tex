\documentclass[11pt,letterpaper,english]{article}
\usepackage[T1]{fontenc} % Standard package for selecting font encodings
\usepackage{txfonts} % makes spacing between characters space correctly
\usepackage{xcolor} % Driver-independent color extensions for LaTeX and pdfLaTeX.
\usepackage{hyperref}  %The ability to create hyperlinks within the document
%\usepackage{blindtext} % To create text
%\usepackage{mdwlist} % mdwlist for compact enumeration/list items
%\usepackage[pagestyles]{titlesec} % related with sections—namely titles, headers and contents
\usepackage{fancyhdr} % header footer placement

\usepackage[top=1in, bottom=1in, left=1in, right=1in] {geometry} % Margins
\usepackage{graphicx}   % Essential for adding images to you document.

\usepackage{sectsty}
\sectionfont{\large}
\subsectionfont{\normalsize}
\subsubsectionfont{\normalsize \it}

\usepackage[font=bf]{caption}
\captionsetup{labelsep=period}


\pagestyle{fancy} % allows you to use the header and footer commands

\raggedright
\begin{document}

\setlength{\parindent}{0in}% Amount of indentation at the first line of a paragraph.


\pagestyle{fancy} \lhead{Revealing the Physics of Galactic Winds with Petascale GPU Simulations} \rhead{Brant Robertson} \renewcommand{%
\headrulewidth}{0.0pt}




\section{PROJECT PLANS FOR NEXT YEAR} 

%The project plans should address the points described below. {\bf This section is typically about 4 pages.} All visual materials, such as charts, graphs, pictures, etc., are included in the page limit; references are {\bf not} included in the page limit.  URLs that provide information related to the application should not be included. \\

%Insert paragraph(s).

\subsection{Summarize the Project Plan} 

%Briefly explain what advances you expect to accomplish through the next award period and associate these with the overarching goals of your project. Clearly explain the relationships between the milestones, planned production simulations, and expected compute time required for these sets of simulations. Explain any change in the scope of the project (research objectives, computational approach, personnel, etc.) relative to the plans and approach articulated in the original proposal. If resource requirements differ from those of the previous year, provide details on the differences (platform, increased/decreased core-hours, file system and archival storage, networking) and the reasons for them. If you are requesting a new resource, you must provide evidence that your project is optimized to run on that resource. See the ``New Code Applications'' section below. Summarize the requirements that are driving the differences and what science/technology outcomes are expected. Significant changes to the original project scope should be discussed with the INCITE program manager prior to submittal.

With the completion of our initial conditions generator and our first production simulation at full resolution, 
our project now turns to efforts to meet our on-going Research Objectives (see Table 1) by achieving our
remaining Research Milestones (see Table 2) via our planned Research Simulations (see Table 3). Our broad Project Plan is
to perform the largest numerical simulations of isolated disk galaxies ever attempted, while including the physics
relevant for generating and characterizing the properties of galactic-scale winds. We have a suite of six
production simulations planned (three in Semester 2 in 2017, two in Semester 3 in 2018, and one in Semester 4 in 2018),
each including the critical radiative cooling physics. The three production simulations conducted in 2018 will include 
detailed models for feedback and wind-driving from individual supernovae events in the ISM, allowing us to self-consistently
produce galactic scale winds and characterize their multiphase structure. All simulations planned use at least 17 billion
cells, and as many as 68 billion cells, exceeding comparable simulations in the literature by two orders of magnitude 
in computational elements. The computational approach and resource requirements are unchanged, as we will use our \textit{Cholla}
code on \textit{Titan} to execute these simulations using our remaining 2017 allocation and the 54M core hours requested
for 2018. Our first production-scale simulation executed at the end of Semester 1 provides us an accurate benchmark for
our computational resource request, and we are confident our research goals can be met with the originally estimated
core hour allocation.
These plans match the scope of our original INCITE proposal, and will be conducted using the
same project personnel (PI Robertson and Co-PI Schneider). 


\subsubsection{Research Milestones}

We will \textit{model the multiphase structure and radiative cooling on galactic outflows on $\sim$10kpc scales} (RM.C)
and \textit{determine the role of full three-dimensionality on the velocity and density structure of galactic outflows} (RM.D)
by performing three production-scale Radiatively Cooling Wind Simulations with 2048x2048x4096 cells (RS.D). The goal will be to 
determine how the properties of the supernovae driving mechanism influence the winds and their ability to cool
into a multiphase structure with rapid outflow velocities. The main determinate of the cooling efficiency is
expected to be the wind density (e.g., Thompson et al. 2016), as the radiative cooling mechanisms increase their
luminosity in proportion to the square of the gas density. Winds that are heavily mass-loaded, such that the
amount of ISM mass driven into the hot wind per supernovae is high, will tend to cool more rapidly than winds
that are less mass-loaded and therefore more rarified. Correspondingly, the planned Radiatively Cooling Wind Simulation
suite will include 1) a simulation using a 
fiducial model for supernovae feedback parameters appropriate for an M82-like system, 2) a ``light
wind'' simulation with lower mass and energy loading into the wind than the fiducial case, and 3) a ``heavy wind''
simulation with higher mass and energy loading. Based on the expectations from our initial moderate-resolution
radiatively cooling simulation we expect to show that the fiducial model of an M82-like galactic wind can
radiatively cool into a multiphase wind, in agreement with observations. We further expect that a well-chosen
``light wind'' model will mimic the results from our production simulation of an
adiabatic wind model from Semester 1, perhaps with some radiative cooling at very large radii. Given these
expectations, the ``heavy wind'' model should also cool quickly, and closer to the disk than the fiducial model.
~\\
~\\

As originally envisioned, all of the production simulations from Semester 2 were going to be quadrants of a galaxy, because the computing time required would have been too great to carry out a global simulation according to our original calculations. However, two factors have made it possible to carry out global simulations in Semester 2. First, we are able to use a more efficient hydrodynamics algorithm than the one used in our estimated time for the original proposal. Second, the simulations do not need to run as long as we initially estimated in order to set up a steady-state wind. While our original proposal specified 400 Myr of evolution, we have found that 100 Myr is sufficient to see the properties of the wind evolve on a global scale.
As a result, our original Research Milestone D: "Determine the role of full three-dimensionality on the velocity and density structure of galactic outflows" will be fulfilled by the simulations being carried out in Semester 2. Thus, we have restructured our milestone timeline somewhat, to better take advantage of the time awarded us in Year 1, and to progress through our proposed research objectives with an approach in which each builds naturally on the next. Despite this restructuring, our overall computational needs have not changed from the original proposal. Below we show the new set of Milestones for our project, along with their associated Research Objectives.
~\\~\\

The main effort of the program in 2018 will be to \textit{determine the mass and energy coupling of ISM gas
to supernova-driven winds} (RO.C). This goal requires a more sophisticated model for supernovae feedback than our
2017 simulations, as the mass- and energy- loading into the winds must be generated self-consistently via the
modeling of supernova events in the disk. Achieving this goal will require us to
\textit{simulate galactic outflows at large dynamic
range to generate ab initial $\sim$10kpc scale winds from $\sim$pc-scale supernovae bubbles} (RM.E), 
implement and test physical models for feedback from star formation, and study the resulting character of the galactic outflow. These studies will enable us to understand how different physical considerations (thermal energy input, momentum driving, spatial and time-clustering of supernovae) change the detailed structure of the galactic wind including the mass-loading, wind velocity and temperature, and the ionization / phase structure of the outflowing gas. The associated Developmental Work is described below.
The critical new capability afforded by our calculations is the reliable tracking of the hydrodynamics and possible cooling of the outflow via fixed grid calculations with massive numbers of cells (>10 billion) densely sampling in the low-density wind regions near the galactic disk. Lagrangian or AMR methods with resolutions that track the gas density provide no gain over 
\textit{Cholla} in this regime, as such approaches purposefully sacrifice resolution in low-density wind regions to more affordably reach high resolution in the star-forming disk. 
~\\~\\
The Research Simulations supporting these objectives and enabling the milestones include 
2048x2048x4096 cell Radiative Cooling Simulations
with discrete SN feedback (RS.E), incorporating
either primarily ``thermal feedback'' or ``momentum feedback'' from supernova (see below), with the expectation that these
models can lead to different mass and momentum loading, thermal energy, and ionization/phase structure in the wind.  These
simulations will be performed at the same resolution as the Radiative Cooling (RS.D) simulations from 2017, allowing us to
directly compare the idealized supernova feedback model from the 2017 efforts with more sophisticated models employed in
2018 and see whether winds driven by individual supernova events differ substantially from winds driven by an engine
supplying a constant mass and energy flux into the outflow.  Once the RS.E models have been analyzed, we will select
one model for a High-Res Radiative Cooling Simulation with discrete SN feedback (RS.F) at 4096$^3$, a truly petascale simulation
that we expect will require 16,384 GPUs and about 32M core hours to execute. This model will enable us to model with
high fidelity both the detailed structure of the interstellar medium in the galactic disk, the mass and energy loading
of the wind on $2-3$pc scales over $10$kpc regions, 
and monitor the early phases of how the galactic wind launches. We believe such a 
simulation is required to successfully achieve milestone RM.E, as the high-resolution in and above the disk enable
us to simultaneously model the interstellar medium and multiphase galactic wind structures. The simulation will serve
as a culmination of the entire project, and will provide a substantial science highlight for the \textit{Titan} facility.



\begin{table}[h]
%\centering
\vspace{-.12in}
\begin{tabular}{|l|p{6.0in}|} 
\multicolumn{2}{l}{\bf{Table 1: On-going INCITE Proposal Research Objectives}}\\
\hline
\textbf{RO.B} & Quantify the importance of radiative cooling 
for the multiphase structure of observed galactic outflows (PARTIALLY COMPLETE).\\ \hline
\textbf{RO.C} & Determine the mass and energy coupling of ISM gas to supernova-driven outflows.\\
\hline
\end{tabular}
\end{table}


\begin{table}[h]
%\centering
\vspace{-.12in}
\begin{tabular}{|l|p{5.0in}|l|} 
\multicolumn{3}{l}{\bf{Table 2: On-going INCITE Proposal Research Milestones}}\\
\hline
\multicolumn{2}{|l|}{\bf Milestone} & {\bf Objective} \\ \hline
\multicolumn{3}{|c|}{\it Semester 2} \\ \hline
\textbf{RM.C} & Model the multiphase structure and radiative cooling of galactic
outflows on $\sim10$kpc scales (PARTIALLY COMPLETE). & RO.B \\ \hline
\multicolumn{3}{|c|}{\it Semester 3} \\ \hline
\textbf{RM.D} & Determine the role of full three-dimensionality on the velocity and density
structure of galactic outflows (PARTIALLY COMPLETE). & RO.B\\ \hline
\multicolumn{3}{|c|}{\it Semester 4} \\ \hline
\textbf{RM.E} & Simulate galactic outflows at large dynamic range to generate {\it ab initio} $\sim10$kpc-scale winds from $\sim$pc-scale supernovae bubbles. & RO.B, RO.C\\ 
\hline
\end{tabular}
\end{table}

\begin{table}[h]
%\centering
\vspace{-.12in}
\begin{tabular}{|l|p{2.5in}|p{1in}|p{0.7in}|p{0.5in}|p{0.7in}|} 
\multicolumn{6}{l}{\bf{Table 3: On-going and Planned Research Simulations}}\\
\hline
\multicolumn{2}{|l|}{\bf Simulation Type and Details} & {\bf Objective / Milestone} & {\bf Resolution} & {\bf Titan Nodes} & {\bf Titan Core Hours} \\ \hline
\multicolumn{6}{|c|}{\it Semester 2: 33M core hours in 2017 (already allocated)} \\ \hline
\textbf{RS.D} & 3 Radiative Cooling Wind Simulations & RO.B, RM.C, RM.D & $N=2048^2\times4096$ &8192&33M\\ \hline
\multicolumn{6}{|c|}{\it Semester 3 (2018): 22M core hours} \\ \hline
\textbf{RS.E} & 2 Radiative Cooling Simulations with discrete SN feedback & RO.B, RO.C, RM.D, RM.E & $N=2048^2\times4096$ &8192&22M\\ \hline
\multicolumn{6}{|c|}{\it Semester 4 (2018): 32M core hours} \\ \hline
\textbf{RS.F} & High-Res Radiative Cooling Simulation with discrete SN feedback& RO.B, RO.C, RM.D, RM.E & $N=4096^3$ &16,384&32M\\ \hline \hline
&\multicolumn{4}{|l|}{Core Hour Budget for Calibration Simulations and Data Analysis} & 4M\\ \hline
\multicolumn{5}{|l|}{\bf Second Year Total Titan Core Hour Request (Unchanged):} & {\bf 58M} \\ \hline
\end{tabular}
\end{table}

%\begin{table}[h]
%\centering
%\vspace{-.12in}
%\begin{tabular}{|l|p{4.6in}|l|} 
%\multicolumn{3}{l}{\bf{Table 1: Updated Research Milestones}}\\
%\hline
%\multicolumn{2}{|l|}{\bf Milestone} & {\bf Objective} \\ \hline
%\multicolumn{3}{|c|}{\it Year 1, Semester 1} \\ \hline
%\textbf{RM.A} & Create and test initial conditions for galactic disk simulations. & RO.A \\ \hline
%\textbf{RM.B} & Implement and calibrate feedback model for driving galactic outflows. & RO.A\\ \hline
%\multicolumn{3}{|c|}{\it Year 1, Semester 2} \\ \hline
%\textbf{RM.C} & Model the multiphase structure and radiative cooling of galactic
%outflows on $\sim10$kpc scales. & RO.A, RO.B \\ \hline
%\textbf{RM.D} & Determine the role of full three-dimensionality on the velocity and density
%structure of galactic outflows. & RO.A, RO.B\\ \hline
%\multicolumn{3}{|c|}{\it Year 2, Semester 1} \\ \hline
%\textbf{RM.E} & Implement and calibrate discrete supernova feedback model for driving galactic outflows & RO.A, RO.B\\ \hline
%\textbf{RM.F} & Model the multiphase structure and radiative cooling of galactic outflows on $\sim10$kpc scales, including driving by discrete supernovae.\\ \hline
%\multicolumn{3}{|c|}{\it Year 2, Semester 2} \\ \hline
%\textbf{RM.G} & Simulate galactic outflows at large dynamic range to generate {\it ab initio} $\sim10$kpc-scale winds from $\sim$pc-scale supernovae bubbles. & RO.A, RO.B, RO.C\\ 
%\hline
%\end{tabular}
%\end{table}

%Because we have restructured the timeline somewhat, we have updated set of proposed simulations for Year 2. In Table 2, we list the simulations that will be completed in Year 1 and 2, along with the research objectives and milestones being addressed by each. Note that the total allocation request has not changed for Year 2.

%\begin{table}[h]
%\centering
%\vspace{-.12in}
%\begin{tabular}{|l|p{2.5in}|p{1in}|p{0.7in}|p{0.5in}|p{0.7in}|} 
%\multicolumn{6}{l}{\bf{Table 2: Research Simulations}}\\
%\hline
%\multicolumn{2}{|l|}{\bf Simulation Type and Details} & {\bf Objective / Milestone} & {\bf Resolution} & {\bf Titan Nodes} & {\bf Titan Core Hours} \\ \hline
%\multicolumn{6}{|c|}{\it Semester 1: 2M core hours} \\ \hline
%\textbf{RS.A} & Initial Conditions Test Simulations & RO.A & $N=1024^3$ &512&0.5M\\ \hline
%\textbf{RS.B} & Feedback Model Calibration Simulations & RO.A & $N=1024^2\times2048$ &1024&1.5M\\ \hline
%\multicolumn{6}{|c|}{\it Semester 2: 44M core hours} \\ \hline
%\textbf{RS.C} & Adiabatic Wind Simulation & RO.A, RO.B & $N=2048^2\times4096$ &8192&11M\\ \hline
%\textbf{RS.D} & 3 Radiative Wind Simulations & RO.A, RO.B & $N=2048^2\times4096$ &8192&33M\\ \hline
%\multicolumn{6}{|c|}{\it Semester 3: 22M core hours} \\ \hline
%\textbf{RS.F} & 2 Radiative Simulations with discrete SN feedback & RO.A, RO.B, RO.C & $N=2048^2\times4096$ &8192&36M\\ \hline
%\multicolumn{6}{|c|}{\it Semester 4: 32M core hours} \\ \hline
%\textbf{RS.G} & High-Res Radiative Simulation & RO.A, RO.B, RO.C & $N=4096^3$ &16,384&32M\\ \hline \hline
%&\multicolumn{4}{|l|}{Core Hour Budget for Analysis and Data Manipulation} & 5M\\ \hline
%\multicolumn{5}{|l|}{\bf Two-Year Program Total Titan Core Hour Request:} & {\bf 104M} \\ \hline
%\end{tabular}
%\end{table}




\subsection{Developmental Work} 

%Describe what, if any, developmental work has been carried out and the outcome of this work. Describe what additional development work will be executed, and when. Provide an estimate for the percentage of project time you will spend on developmental computing (e.g., porting, performance analysis) and other nonproduction runs.

In Semester 1 in 2017, we performed some developmental work to create the initial conditions generator for our isolated
disk simulations, implement and test the supernovae feedback model for driving galactic winds, and test the radiative
cooling simulations. We also improved the hydrodynamical integration routines in \textit{Cholla}, making them more efficient
and allowing us to jump directly to global disk simulations instead of our originally planned quadrant simulations. This
developmental work was integrated into our original project timeline, and was refelected in our slow initial burn rate (as
planned). 
~\\~\\
With the initial developmental work completed, the vast majority of our computational resources will be dedicated to peforming
production scale simulations ($>95$\%). While our production resolution Radiative Cooling Wind Simulations (RS.D) are running on \textit{Titan}, we will pursue some additional developmental work during Semester 2 in 2017 (indeed, our plan would permit our entire 2017 allocation to be exhausted by October 2017 depending on the utilization of the \textit{Titan} queue). This developmental work will require $<5$\% of our computational resources.
~\\~\\
For our radiatively cooling simulations with discrete SN feedback (RS.E, RS.F), we will implement and test two or more supernovae feedback models. The first model will input stochastic energy sources in 10pc x 10pc regions with a spatial sampling following the expected star formation rate density in the disk and a time sampling appropriate of averages over the lifetimes and initial mass function of massive stars in stellar clusters (e.g., Gentry et al. 2017). Given that these supernova-heated regions will marginally resolve the size of the supernovae remnants as they enter the momentum-conserving phase, we will use the local density around the supernovae to estimate any missing momentum deposition and add that as a radially-diverging kinetic feedback. A second model will combine a smooth volumetric heating of the disk gas from a time-averaged supernovae rate with stochastic momentum feedback from star formation (e.g., Ostriker et al. 2010), which is expected to have a similar net effect but may lead to differing temperature, momentum, and ionization structure in the wind.
Given that the disk gas will be allowed to cool radiatively, heating from supernovae directly or secondary heating from supernova-driven turbulence will be required to maintain the observed disk thickness of M82. We will perform a small series of resolution studies focused on the disk to verify the implementation of each feedback prescription, calibrate its efficiency to drive galactic winds, and develop yet further prescriptions if they prove unsuccessful. We have extensive experience implementing ISM and feedback models (Robertson and Kravtsov 2008) that are widely used in galaxy simulations, and correspondingly this phase of the program poses little risk to our research objectives. 

\subsection{New Code Applications (where relevant)} 

%Are you planning to use any new production codes next year that were not included in your original proposal? Or are you proposing use of a new resource not included in your original proposal? If so, provide direct evidence, including supporting quantitative data, for your production application’s parallel performance for the intended research simulations. Ideally, the proposing team will have generated the data. If you cite work by others, explain why it is applicable here. You should use the application code you intend for the production work, not a related code. Data for sample systems not related to the intended research is undesirable. Performance benchmarking should reflect all I/O requirements. Parallel performance data in either strong or weak scaling mode must be provided. Explain how the strong or weak scaling applies to the proposed work. 

%NOTE: You may apply for a startup account at one of the centers to conduct performance studies. Applications are available at

%ANL: {\href{http://www.alcf.anl.gov/getting-started/apply-for-dd}{http://www.alcf.anl.gov/getting-started/apply-for-dd}}

%ORNL: {\href{www.olcf.ornl.gov/support/getting-started/olcf-director-discretion-project-application}{www.olcf.ornl.gov/support/getting-started/olcf-director-discretion-project-application}}

We do not plan to use any new codes in Year 2. We will continue to update and improve our primary hydrodynamics code, \textit{Cholla}, used to carry out all of the described simulations. We do not require additional
resources beyond those requested in our original proposal.

\vspace{.08in}
\textbf{REFERENCES}
\vspace{6pt}

%References must be single-column format, 11 point, Arial or Times New Roman.

\begin{enumerate}\itemsep0pt

\item Gentry, E., et al. ``Enhanced momentum feedback from clustered supernovae." \emph{MNRAS}, \textbf{465}, 2471(2017)
\item Ostriker, E., et al. ``Regulation of Star Formation Rates in Multiphase Galactic Disks: A Thermal/Dynamical Equilibrium Model.'' \emph{ApJ}, \textbf{721}, 975 (2010)
\item Robertson, B., and Kravtsov, A. "Molecular Hydrogen and Global Star Formation Relations in Galaxies", \emph{ApJ}, \textbf{680}, 1083 (2008)
\item Thompson, T.A., et al. ``An Origin for Multiphase Gas in Galactic Winds and Haloes" \emph{MNRAS}, \textbf{455}(2): 1830--1844 (2016). \\

\end{enumerate}


\end{document}
